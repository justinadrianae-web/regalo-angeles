<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Para ti ‚ú®</title>
    <style>
        body { margin: 0; overflow: hidden; background-color: #050a1f; font-family: 'Helvetica', sans-serif; }
        canvas { display: block; cursor: grab; }
        canvas:active { cursor: grabbing; }
        
        #ui { position: absolute; top: 15px; width: 100%; text-align: center; color: #bde0fe; text-shadow: 0 0 10px #a2d2ff; pointer-events: none; z-index: 5; }
        #ui h1 { margin: 0; font-size: 2.2em; letter-spacing: 2px; }
        #ui p { margin: 10px 0 0 0; color: #eaf4f4; font-size: 1.1em; }

        #search-container {
            position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
            background: rgba(10, 20, 45, 0.8); border: 2px solid #a2d2ff; border-radius: 30px;
            padding: 10px 20px; display: flex; gap: 10px; z-index: 10; backdrop-filter: blur(5px);
            box-shadow: 0 0 20px rgba(162, 210, 255, 0.3);
        }
        #coord-input {
            background: transparent; border: none; color: white; font-size: 1em; outline: none;
            text-align: center; width: 180px; font-family: monospace;
        }
        #coord-input::placeholder { color: #bde0fe; opacity: 0.7; }
        #search-btn {
            background: linear-gradient(45deg, #a2d2ff, #cdb4db); border: none; color: #050a1f; padding: 8px 20px;
            border-radius: 20px; cursor: pointer; font-weight: bold; transition: 0.3s;
        }
        #search-btn:hover { transform: scale(1.05); box-shadow: 0 0 10px #cdb4db; }

        #modal {
            display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            background: rgba(5, 10, 31, 0.95); border: 3px solid #cdb4db; border-radius: 25px;
            padding: 40px; text-align: center; color: white; box-shadow: 0 0 50px rgba(205, 180, 219, 0.4);
            width: 85%; max-width: 550px; z-index: 100; backdrop-filter: blur(10px);
        }
        #modal h2 { margin: 0 0 20px 0; font-size: 2.2em; color: #fcf6bd; text-shadow: 1px 1px 10px #cdb4db; font-weight: bold;}
        #modal p { font-size: 1.6em; line-height: 1.5; font-weight: 500; color: #f8f9fa; font-style: italic; }
        #modal-coord { display: block; margin-top: 20px; font-size: 1em; color: #bde0fe; font-family: monospace; }
        #close-btn {
            background: linear-gradient(45deg, #a2d2ff, #cdb4db); border: none; color: #050a1f; padding: 15px 40px; 
            font-size: 1.2em; border-radius: 50px; cursor: pointer; margin-top: 20px; font-weight: bold;
            box-shadow: 0 5px 20px rgba(162, 210, 255, 0.4); transition: 0.3s;
        }
        #close-btn:hover { transform: scale(1.05); box-shadow: 0 5px 30px rgba(205, 180, 219, 0.7); }
    </style>
</head>
<body>

    <div id="ui">
        <h1>‚ú® Un Espacio Seguro ‚ú®</h1>
        <p>Toca la pantalla para encender la m√∫sica üéµ<br>Respira profundo y explora las estrellas üëá</p>
    </div>

    <div id="search-container">
        <input type="text" id="coord-input" placeholder="Ej: 01.00.00">
        <button id="search-btn" onclick="searchCoordinate()">Buscar</button>
    </div>

    <audio id="bg-music" loop hidden>
        <source src="cancion.mp3" type="audio/mpeg">
    </audio>

    <div id="modal">
        <h2 id="modal-title">T√≠tulo</h2>
        <p id="modal-text">Mensaje</p>
        <span id="modal-coord"></span><br>
        <button id="close-btn" onclick="document.getElementById('modal').style.display='none'">Un abrazo ü´Ç</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    
    <script>
        window.addEventListener('click', function() {
            const audio = document.getElementById('bg-music');
            if (audio.paused) {
                audio.volume = 0.4;
                audio.play().catch(e => console.log("Esperando interacci√≥n..."));
            }
        }, { once: true });

        const scene = new THREE.Scene();
        scene.fog = new THREE.FogExp2(0x050a1f, 0.0015);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 2000);
        camera.position.z = 160;

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        const controls = new THREE.OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.15; 

        const particlesGeometry = new THREE.BufferGeometry();
        const particlesCount = 9000;
        const posArray = new Float32Array(particlesCount * 3);
        const colorsArray = new Float32Array(particlesCount * 3);

        for(let i = 0; i < particlesCount * 3; i+=3) {
            const r = 300 * Math.cbrt(Math.random());
            const theta = Math.random() * 2 * Math.PI;
            const phi = Math.acos(2 * Math.random() - 1);
            
            posArray[i] = r * Math.sin(phi) * Math.cos(theta);
            posArray[i+1] = r * Math.sin(phi) * Math.sin(theta);
            posArray[i+2] = r * Math.cos(phi) * 0.6; 

            const colorTheme = Math.random();
            if(colorTheme > 0.66) { 
                colorsArray[i] = 0.63; colorsArray[i+1] = 0.82; colorsArray[i+2] = 1.0; 
            } else if (colorTheme > 0.33) { 
                colorsArray[i] = 0.8; colorsArray[i+1] = 0.7; colorsArray[i+2] = 0.85; 
            } else { 
                colorsArray[i] = 0.98; colorsArray[i+1] = 0.96; colorsArray[i+2] = 0.74; 
            }
        }
        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colorsArray, 3));
        const particleMesh = new THREE.Points(particlesGeometry, new THREE.PointsMaterial({ size: 1.3, vertexColors: true, transparent: true, opacity: 0.8, blending: THREE.AdditiveBlending }));
        scene.add(particleMesh);

        const clickableObjects = [];
        const starGeometry = new THREE.SphereGeometry(3, 16, 16);
        const starMaterial = new THREE.MeshBasicMaterial({ color: 0xffffff });
        const haloGeom = new THREE.SphereGeometry(6.5, 16, 16);
        const haloMat = new THREE.MeshBasicMaterial({ color: 0xa2d2ff, transparent: true, opacity: 0.4, blending: THREE.AdditiveBlending });

        // A. Mensajes Principales (Coordenadas exactas)
        const mainMemories = [
            { t: "üèõÔ∏è Futura Colega", m: "Coincidir contigo en este primer semestre de Ciencias Pol√≠ticas ha sido lo mejor que me ha pasado en la facultad.", c: "01.00.00" },
            { t: "‚öñÔ∏è Soberan√≠a Personal", m: "Tu paz mental es territorio soberano. Tienes derecho a veto sobre cualquier cosa que te quite la tranquilidad.", c: "02.00.00" },
            { t: "‚òï Compa√±era de Trinchera", m: "Prometo estar ah√≠ para sobrevivir a los debates, los PDFs interminables y los d√≠as dif√≠ciles. No est√°s sola.", c: "03.00.00" },
            { t: "üåª Zona Neutral", m: "Considera este espacio (y mi amistad) como tu zona desmilitarizada. Cero presiones, solo paz y apoyo.", c: "04.00.00" },
            { t: "üíõ Feliz 14", m: "Quer√≠a darte un detalle diferente hoy. Eres una persona incre√≠ble y una polit√≥loga brillante en proceso.", c: "14.02.26" }
        ];

        // B. Gran base de datos de frases √∫nicas (Para las 145 estrellas restantes)
        const frasesLindas = [
            "Maquiavelo dec√≠a que el fin justifica los medios, pero mi fin es verte sonre√≠r hoy.",
            "Sobrevivir al primer semestre cuenta como deporte extremo, y lo est√°s haciendo genial.",
            "Eres la mejor parte de ir a sentarme al aula todos los d√≠as.",
            "Ni el Leviat√°n de Hobbes es tan imponente como t√∫ cuando participas en clase.",
            "Ojal√° apruebes todas tus materias, pero sobre todo, ojal√° sanes y seas muy feliz.",
            "En el parlamento de la vida, personas como t√∫ deber√≠an tener mayor√≠a absoluta.",
            "Prometo pasarte mis apuntes si alg√∫n d√≠a no tienes ganas de ir a la facultad.",
            "Contigo, hasta leer 50 p√°ginas de PDFs de teor√≠a pol√≠tica se hace menos pesado.",
            "Despu√©s de la anarqu√≠a emocional siempre llega un nuevo orden. Todo va a estar bien.",
            "Tienes madera para cambiar el mundo, o al menos para hacer mi mundo mejor en clase.",
            "Tienes una mente brillante, nunca dejes que nadie te haga dudar de eso.",
            "Veto absoluto a las malas vibras. Tienes derecho a sanar a tu ritmo.",
            "Admiro tu fuerza para seguir adelante y sentarte en el curso todos los d√≠as.",
            "Me encanta tu forma de ver las cosas cuando debatimos alg√∫n tema.",
            "Eres de esas personas que mejoran cualquier ambiente solo con llegar.",
            "Respira profundo, ning√∫n imperio se construy√≥ en un d√≠a, ni se sana en una noche.",
            "Eres suficiente, exactamente tal y como eres.",
            "Est√° bien no estar bien todo el tiempo. Se vale descansar.",
            "Un abrazo gigante a la distancia, futura colega.",
            "Mereces rodearte de cosas que te hagan sentir en paz.",
            "Tu estabilidad emocional es la mejor pol√≠tica p√∫blica que puedes aplicar hoy.",
            "Recuerda ser amable contigo misma. Es un proceso.",
            "Aqu√≠ tienes a un compa√±ero que se alegra de que existas.",
            "A veces la mejor diplomacia es desconectar del mundo y cuidarte a ti misma.",
            "Me caes demasiado bien. As√≠, sin exagerar.",
            "Tu compa√±√≠a siempre es un buen plan, aunque sea entre clases.",
            "10/10. Excelente servicio como amiga y compa√±era.",
            "Que no se te olvide lo incre√≠ble que eres, incluso en los d√≠as nublados.",
            "Firmemos un tratado de paz: hoy est√° prohibido sobrepensar.",
            "Eres luz en el campus."
        ];

        // Mezclar las frases aleatorias para que cada estrella se sienta √∫nica
        for(let i = 0; i < 150; i++) {
            const star = new THREE.Mesh(starGeometry, starMaterial);
            const spread = 200;
            star.position.set((Math.random() - 0.5) * spread, (Math.random() - 0.5) * spread, (Math.random() - 0.5) * spread);
            
            let data;
            if(i < mainMemories.length) {
                data = { title: mainMemories[i].t, text: mainMemories[i].m, coord: mainMemories[i].c };
                star.scale.set(1.4, 1.4, 1.4);
            } else {
                // Selecciona una frase de la lista amplia
                let frase = frasesLindas[Math.floor(Math.random() * frasesLindas.length)];
                let coordSec = "77." + Math.floor(Math.random() * 90 + 10) + "." + i;
                data = { title: "‚ú® Un recordatorio", text: frase, coord: coordSec };
            }

            star.userData = data;
            scene.add(star);
            clickableObjects.push(star); 
            
            const halo = new THREE.Mesh(haloGeom, haloMat);
            star.add(halo);
        }

        const raycaster = new THREE.Raycaster();
        const mouse = new THREE.Vector2();

        function openModal(data) {
            controls.autoRotate = false; 
            document.getElementById('modal-title').innerHTML = data.title;
            document.getElementById('modal-text').innerHTML = data.text;
            document.getElementById('modal-coord').innerHTML = "Coordenada: " + data.coord;
            document.getElementById('modal').style.display = 'block';
        }

        function checkIntersection(clientX, clientY) {
            mouse.x = (clientX / window.innerWidth) * 2 - 1;
            mouse.y = -(clientY / window.innerHeight) * 2 + 1;
            raycaster.setFromCamera(mouse, camera);

            const intersects = raycaster.intersectObjects(clickableObjects);
            if (intersects.length > 0) openModal(intersects[0].object.userData);
        }

        window.addEventListener('click', (e) => {
            if(e.target.id !== 'coord-input' && e.target.id !== 'search-btn' && e.target.id !== 'close-btn') {
                checkIntersection(e.clientX, e.clientY);
            }
        });
        window.addEventListener('touchstart', (e) => {
            if(e.target.id !== 'coord-input' && e.target.id !== 'search-btn' && e.target.id !== 'close-btn') {
                if(e.touches.length > 0) checkIntersection(e.touches[0].clientX, e.touches[0].clientY);
            }
        });

        window.searchCoordinate = function() {
            const inputVal = document.getElementById('coord-input').value.trim();
            if(!inputVal) return;
            const starFound = clickableObjects.find(star => star.userData.coord === inputVal);
            if(starFound) {
                openModal(starFound.userData);
                document.getElementById('coord-input').value = ""; 
            } else {
                alert("Estrella no encontrada. Sigue explorando.");
            }
        };

        document.getElementById('coord-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') searchCoordinate();
        });

        function animate() {
            requestAnimationFrame(animate);
            particleMesh.rotation.y += 0.0003; 
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
